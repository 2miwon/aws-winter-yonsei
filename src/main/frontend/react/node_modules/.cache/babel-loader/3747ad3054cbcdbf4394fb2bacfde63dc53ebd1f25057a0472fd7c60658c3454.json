{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useLocation,useNavigate}from'react-router-dom';import DatePicker from\"react-datepicker\";import*as EgovNet from'api/egovFetch';import URL from'constants/url';import CODE from'constants/code';import{default as EgovLeftNav}from'components/leftmenu/EgovLeftNavAdmin';import EgovAttachFile from'components/EgovAttachFile';import EgovRadioButtonGroup from'components/EgovRadioButtonGroup';import'react-datepicker/dist/react-datepicker.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EgovAdminScheduleEdit(props){console.group(\"EgovAdminScheduleEdit\");console.log(\"[Start] EgovAdminScheduleEdit ------------------------------\");console.log(\"EgovAdminScheduleEdit [props] : \",props);const navigate=useNavigate();const location=useLocation();console.log(\"EgovAdminScheduleEdit [location] : \",location);const reptitSeCodeRadioGroup=[{value:\"1\",label:\"당일\"},{value:\"2\",label:\"반복\"},{value:\"3\",label:\"연속\"}];const[modeInfo,setModeInfo]=useState({mode:props.mode});const[scheduleDetail,setScheduleDetail]=useState({schdulDeptName:\"관리자부서\",schdulChargerName:\"관리자\",schdulKindCode:2,reptitSeCode:\"1\",startDate:new Date(),endDate:new Date()});const[boardAttachFiles,setBoardAttachFiles]=useState();const[schdulBgndeHH,setSchdulBgndeHH]=useState();const[schdulBgndeMM,setSchdulBgndeMM]=useState();const[schdulEnddeHH,setSchdulEnddeHH]=useState();const[schdulEnddeMM,setSchdulEnddeMM]=useState();const initMode=()=>{switch(props.mode){case CODE.MODE_CREATE:setModeInfo({...modeInfo,modeTitle:\"등록\",method:\"POST\",editURL:'/schedule'});break;case CODE.MODE_MODIFY:setModeInfo({...modeInfo,modeTitle:\"수정\",method:\"PUT\",editURL:'/schedule'});break;default:navigate({pathname:URL.ERROR},{state:{msg:\"\"}});}retrieveDetail();};const convertDate=str=>{let year=str.substring(0,4);let month=str.substring(4,6);let date=str.substring(6,8);let hour=str.substring(8,10);let minute=str.substring(10,12);return new Date(year,month-1,date,hour,minute);};const retrieveDetail=()=>{var _location$state;if(modeInfo.mode===CODE.MODE_CREATE){// 조회/등록이면 조회 안함\nsetScheduleDetail({...scheduleDetail,schdulBgnde:location.state.iUseDate,schdulEndde:location.state.iUseDate,startDate:convertDate(location.state.iUseDate),endDate:convertDate(location.state.iUseDate)});return;}const retrieveDetailURL=\"/schedule/\".concat((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.schdulId);const requestOptions={method:\"GET\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(retrieveDetailURL,requestOptions,function(resp){let rawScheduleDetail=resp.result.scheduleDetail;//기본값 설정\nsetScheduleDetail({...scheduleDetail,...rawScheduleDetail,startDate:convertDate(rawScheduleDetail.schdulBgnde),endDate:convertDate(rawScheduleDetail.schdulEndde),atchFileId:rawScheduleDetail.atchFileId.trim()});setBoardAttachFiles(resp.result.resultFiles);});};const updateSchedule=()=>{const formData=new FormData();for(let key in scheduleDetail){formData.append(key,scheduleDetail[key]);console.log(\"scheduleDetail [%s] \",key,scheduleDetail[key]);}if(formValidator(formData)){const requestOptions={method:modeInfo.method,body:formData};if(modeInfo.mode===CODE.MODE_MODIFY){var _location$state2;modeInfo.editURL=\"\".concat(modeInfo.editURL,\"/\").concat((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.schdulId);}EgovNet.requestFetch(modeInfo.editURL,requestOptions,resp=>{if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){navigate({pathname:URL.ADMIN_SCHEDULE});}else{navigate({pathname:URL.ERROR},{state:{msg:resp.resultMessage}});}});}};const formValidator=formData=>{if(formData.get('schdulNm')===null||formData.get('schdulNm')===\"\"){alert(\"일정명은 필수 값입니다.\");return false;}if(formData.get('schdulCn')===null||formData.get('schdulCn')===\"\"){alert(\"일정내용은 필수 값입니다.\");return false;}if(formData.get('schdulSe')===null||formData.get('schdulSe')===\"\"){alert(\"일정구분은 필수 값입니다.\");return false;}if(formData.get('schdulIpcrCode')===null||formData.get('schdulIpcrCode')===\"\"){alert(\"중요도는 필수 값입니다.\");return false;}if(formData.get('reptitSeCode')===null||formData.get('reptitSeCode')===\"\"){alert(\"반복구분은 필수 값입니다.\");return false;}if(formData.get('schdulBgnde')>formData.get('schdulEndde')){alert(\"종료일시는 시작일시보다 앞 설 수 없습니다.\");return false;}return true;};const getDateFourteenDigit=date=>{return getYYYYMMDD(date).toString()+makeTwoDigit(date.getHours())+makeTwoDigit(date.getMinutes())+makeTwoDigit(date.getSeconds());};const getYYYYMMDD=date=>{return date.getFullYear().toString()+makeTwoDigit(Number(date.getMonth()+1))+makeTwoDigit(date.getDate());};const makeTwoDigit=number=>{return number<10?\"0\"+number:number.toString();};useEffect(function(){initMode();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);console.log(\"------------------------------EgovAdminScheduleEdit [End]\");console.groupEnd(\"EgovAdminScheduleEdit\");return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c_wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"location\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.MAIN,className:\"home\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.ADMIN,children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),/*#__PURE__*/_jsx(\"li\",{children:\"\\uC77C\\uC815\\uAD00\\uB9AC\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(EgovLeftNav,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents SITE_SCHDULE_REG\",id:\"contents\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"top_tit\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"tit_1\",children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"tit_2\",children:\"\\uC77C\\uC815\\uAD00\\uB9AC \\uC0C1\\uC138\\uBCF4\\uAE30\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_view2\",children:[/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uC77C\\uC815\\uAD6C\\uBD84\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"label\",{className:\"f_select w_130\",htmlFor:\"schdulSe\",children:/*#__PURE__*/_jsxs(\"select\",{id:\"schdulSe\",name:\"schdulSe\",title:\"\\uC77C\\uC815\\uAD6C\\uBD84\",value:scheduleDetail.schdulSe,onChange:e=>setScheduleDetail({...scheduleDetail,schdulSe:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"\\uD68C\\uC758\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"\\uC138\\uBBF8\\uB098\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"\\uAC15\\uC758\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"\\uAD50\\uC721\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"\\uAE30\\uD0C0\"})]})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uC911\\uC694\\uB3C4\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"label\",{className:\"f_select w_130\",htmlFor:\"schdulIpcrCode\",children:/*#__PURE__*/_jsxs(\"select\",{id:\"schdulIpcrCode\",name:\"schdulIpcrCode\",title:\"\\uC911\\uC694\\uB3C4\",value:scheduleDetail.schdulIpcrCode,onChange:e=>setScheduleDetail({...scheduleDetail,schdulIpcrCode:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A\",children:\"\\uB192\\uC74C\"}),/*#__PURE__*/_jsx(\"option\",{value:\"B\",children:\"\\uBCF4\\uD1B5\"}),/*#__PURE__*/_jsx(\"option\",{value:\"C\",children:\"\\uB0AE\\uC74C\"})]})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"schdulDeptName\",children:\"\\uBD80\\uC11C\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"f_input2 w_full\",type:\"text\",name:\"schdulDeptName\",title:\"\\uBD80\\uC11C\",id:\"schdulDeptName\",value:scheduleDetail.schdulDeptName,readOnly:true})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"schdulNm\",children:\"\\uC77C\\uC815\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"f_input2 w_full\",type:\"text\",name:\"schdulNm\",title:\"\\uBD80\\uC11C\",id:\"schdulNm\",placeholder:\"\\uC77C\\uC815 \\uD14C\\uC2A4\\uD2B8\",defaultValue:scheduleDetail.schdulNm,onChange:e=>setScheduleDetail({...scheduleDetail,schdulNm:e.target.value})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"schdulCn\",children:\"\\uC77C\\uC815\\uB0B4\\uC6A9\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"textarea\",{className:\"f_txtar w_full h_100\",name:\"schdulCn\",id:\"schdulCn\",cols:\"30\",rows:\"10\",placeholder:\"\\uC77C\\uC815\\uB0B4\\uC6A9\",defaultValue:scheduleDetail.schdulCn,onChange:e=>setScheduleDetail({...scheduleDetail,schdulCn:e.target.value})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uBC18\\uBCF5\\uAD6C\\uBD84\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(EgovRadioButtonGroup,{name:\"reptitSeCode\",radioGroup:reptitSeCodeRadioGroup,setValue:scheduleDetail.reptitSeCode.trim(),setter:v=>setScheduleDetail({...scheduleDetail,reptitSeCode:v})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uB0A0\\uC9DC/\\uC2DC\\uAC04\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsxs(\"dd\",{className:\"datetime\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"line_break\",children:[/*#__PURE__*/_jsx(DatePicker,{selected:scheduleDetail.startDate,name:\"schdulBgnde\",className:\"f_input\",dateFormat:\"yyyy-MM-dd HH:mm\",showTimeInput:true,onChange:date=>{console.log(\"setStartDate : \",date);setScheduleDetail({...scheduleDetail,schdulBgnde:getDateFourteenDigit(date),schdulBgndeYYYMMDD:getYYYYMMDD(date),schdulBgndeHH:date.getHours(),schdulBgndeMM:date.getMinutes(),startDate:date});setSchdulBgndeHH(date.getHours());setSchdulBgndeMM(date.getMinutes());}}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"schdulBgndeHH\",defaultValue:schdulBgndeHH,readOnly:true}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"schdulBgndeMM\",defaultValue:schdulBgndeMM,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"f_inn_txt\",children:\"~\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"line_break\",children:[/*#__PURE__*/_jsx(DatePicker,{selected:scheduleDetail.endDate,name:\"schdulEndde\",className:\"f_input\",dateFormat:\"yyyy-MM-dd HH:mm\",showTimeInput:true,minDate:scheduleDetail.startDate,onChange:date=>{console.log(\"setEndDate: \",date);setScheduleDetail({...scheduleDetail,schdulEndde:getDateFourteenDigit(date),schdulEnddeYYYMMDD:getYYYYMMDD(date),schdulEnddeHH:date.getHours(),schdulEnddeMM:date.getMinutes(),endDate:date});setSchdulEnddeHH(date.getHours());setSchdulEnddeMM(date.getMinutes());}}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"schdulEnddeHH\",defaultValue:schdulEnddeHH,readOnly:true}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"schdulEnddeMM\",defaultValue:schdulEnddeMM,readOnly:true})]})]})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"schdulChargerName\",children:\"\\uB2F4\\uB2F9\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"f_input2 w_full\",type:\"text\",name:\"schdulChargerName\",id:\"schdulChargerName\",defaultValue:\"\\uAD00\\uB9AC\\uC790\",readOnly:true})})]}),/*#__PURE__*/_jsx(EgovAttachFile,{fnChangeFile:attachfile=>{console.log(\"====>>> Changed attachfile file = \",attachfile);const arrayConcat={...scheduleDetail};// 기존 단일 파일 업로드에서 다중파일 객체 추가로 변환(아래 for문으로)\nfor(let i=0;i<attachfile.length;i++){arrayConcat[\"file_\".concat(i)]=attachfile[i];}setScheduleDetail(arrayConcat);},fnDeleteFile:deletedFile=>{console.log(\"====>>> Delete deletedFile = \",deletedFile);setBoardAttachFiles(deletedFile);},boardFiles:boardAttachFiles,mode:props.mode}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_btn_area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left_col btn1\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_skyblue_h46 w_100\",onClick:()=>updateSchedule(),children:\" \\uC800\\uC7A5\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#!\",className:\"btn btn_skyblue_h46 w_100\",children:\"\\uC0AD\\uC81C\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"right_col btn1\",children:/*#__PURE__*/_jsx(Link,{to:URL.ADMIN_SCHEDULE,className:\"btn btn_blue_h46 w_100\",children:\"\\uBAA9\\uB85D\"})})]})]})]})]})]})});}export default EgovAdminScheduleEdit;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
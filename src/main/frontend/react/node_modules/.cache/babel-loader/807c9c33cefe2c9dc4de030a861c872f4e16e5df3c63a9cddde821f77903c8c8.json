{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useLocation,useNavigate}from'react-router-dom';import*as EgovNet from'api/egovFetch';import URL from'constants/url';import CODE from'constants/code';import{NOTICE_BBS_ID}from'config';import{default as EgovLeftNav}from'components/leftmenu/EgovLeftNavAdmin';import EgovAttachFile from'components/EgovAttachFile';import bbsFormVaildator from'utils/bbsFormVaildator';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EgovAdminNoticeEdit(props){var _location$state,_location$state2;console.group(\"EgovAdminNoticeEdit\");console.log(\"------------------------------\");console.log(\"EgovAdminNoticeEdit [props] : \",props);const navigate=useNavigate();const location=useLocation();console.log(\"EgovAdminNoticeEdit [location] : \",location);const bbsId=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.bbsId)||NOTICE_BBS_ID;const nttId=((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.nttId)||\"\";const[modeInfo,setModeInfo]=useState({mode:props.mode});const[masterBoard,setMasterBoard]=useState({});const[boardDetail,setBoardDetail]=useState({nttSj:'',nttCn:''});const[boardAttachFiles,setBoardAttachFiles]=useState();const intMode=()=>{switch(props.mode){case CODE.MODE_CREATE:setModeInfo({...modeInfo,modeTitle:\"등록\",method:\"POST\",editURL:'/board'});break;case CODE.MODE_MODIFY:setModeInfo({...modeInfo,modeTitle:\"수정\",method:\"PUT\",editURL:\"/board/\".concat(nttId)});break;case CODE.MODE_REPLY:setModeInfo({...modeInfo,modeTitle:\"답글쓰기\",method:\"POST\",editURL:'/boardReply'});break;default:navigate({pathname:URL.ERROR},{state:{msg:\"\"}});}retrieveDetail();};const retrieveDetail=()=>{if(modeInfo.mode===CODE.MODE_CREATE){// 등록이면 마스터 정보에서 파일 첨부 가능 여부 조회함\nconst retrieveDetailURL=\"/boardFileAtch/\".concat(bbsId);const requestOptions={method:\"GET\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(retrieveDetailURL,requestOptions,function(resp){setMasterBoard(resp.result.brdMstrVO);});setBoardDetail({bbsId:bbsId,nttSj:\"\",nttCn:\"\"});return;}const retrieveDetailURL=\"/board/\".concat(bbsId,\"/\").concat(nttId);const requestOptions={method:\"GET\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(retrieveDetailURL,requestOptions,function(resp){setMasterBoard(resp.result.brdMstrVO);// 초기 boardDetail 설정 => ( 답글 / 수정 ) 모드일때...\nif(modeInfo.mode===CODE.MODE_REPLY){// 답글모드이면 RE: 붙여줌 \nsetBoardDetail({...resp.result.boardVO,nttSj:\"RE: \"+resp.result.boardVO.nttSj,nttCn:\"\",inqireCo:0,atchFileId:\"\"});}if(modeInfo.mode===CODE.MODE_MODIFY){setBoardDetail(resp.result.boardVO);}// 초기 setBoardAttachFiles 설정 => (수정) 모드 일때...\nif(modeInfo.mode===CODE.MODE_MODIFY){setBoardAttachFiles(resp.result.resultFiles);}});};const updateBoard=()=>{const formData=new FormData();for(let key in boardDetail){formData.append(key,boardDetail[key]);//console.log(\"boardDetail [%s] \", key, boardDetail[key]);\n}if(bbsFormVaildator(formData)){const requestOptions={method:modeInfo.method,body:formData};EgovNet.requestFetch(modeInfo.editURL,requestOptions,resp=>{if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){navigate(URL.ADMIN_NOTICE,{state:{bbsId:bbsId}});}else{// alert(\"ERR : \" + resp.message);\nnavigate({pathname:URL.ERROR},{state:{msg:resp.resultMessage}});}});};};const Location=/*#__PURE__*/React.memo(function Location(masterBoard){return/*#__PURE__*/_jsx(\"div\",{className:\"location\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.MAIN,className:\"home\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.ADMIN,children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),/*#__PURE__*/_jsx(\"li\",{children:masterBoard&&masterBoard.bbsNm})]})});});useEffect(function(){intMode();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);console.groupEnd(\"EgovAdminNoticeEdit\");return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c_wrap\",children:[/*#__PURE__*/_jsx(Location,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(EgovLeftNav,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents NOTICE_LIST\",id:\"contents\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"top_tit\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"tit_1\",children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),/*#__PURE__*/_jsxs(\"h2\",{className:\"tit_2\",children:[masterBoard&&masterBoard.bbsNm,\" \",modeInfo.modeTitle]}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_view2\",children:[/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsx(\"dt\",{children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"nttSj\",children:[\"\\uC81C\\uBAA9\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]})}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"f_input2 w_full\",id:\"nttSj\",name:\"nttSj\",type:\"text\",defaultValue:boardDetail.nttSj,onChange:e=>setBoardDetail({...boardDetail,nttSj:e.target.value}),maxLength:\"60\"})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsx(\"dt\",{children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"nttCn\",children:[\"\\uB0B4\\uC6A9 \",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]})}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"textarea\",{className:\"f_txtar w_full h_200\",id:\"nttCn\",name:\"nttCn\",cols:\"30\",rows:\"10\",placeholder:\"\",defaultValue:boardDetail.nttCn,onChange:e=>setBoardDetail({...boardDetail,nttCn:e.target.value})})})]}),(modeInfo===null||modeInfo===void 0?void 0:modeInfo.mode)!==CODE.MODE_REPLY&&masterBoard.fileAtchPosblAt==='Y'&&/*#__PURE__*/_jsx(EgovAttachFile,{fnChangeFile:attachfile=>{console.log(\"====>>> Changed attachfile file = \",attachfile);const arrayConcat={...boardDetail};// 기존 단일 파일 업로드에서 다중파일 객체 추가로 변환(아래 for문으로)\nfor(let i=0;i<attachfile.length;i++){arrayConcat[\"file_\".concat(i)]=attachfile[i];}setBoardDetail(arrayConcat);},fnDeleteFile:deletedFile=>{console.log(\"====>>> Delete deletedFile = \",deletedFile);setBoardAttachFiles(deletedFile);},boardFiles:boardAttachFiles,mode:props.mode,posblAtchFileNumber:masterBoard.posblAtchFileNumber}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_btn_area\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"left_col btn1\",children:/*#__PURE__*/_jsx(\"a\",{href:\"#!\",className:\"btn btn_skyblue_h46 w_100\",onClick:e=>{updateBoard();},children:\"\\uC800\\uC7A5\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"right_col btn1\",children:/*#__PURE__*/_jsx(\"a\",{href:URL.ADMIN_NOTICE,className:\"btn btn_blue_h46 w_100\",children:\"\\uBAA9\\uB85D\"})})]})]})]})]})]})});}export default EgovAdminNoticeEdit;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
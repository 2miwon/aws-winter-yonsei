{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Link,useNavigate,useLocation}from'react-router-dom';import*as EgovNet from'api/egovFetch';import URL from'constants/url';import CODE from'constants/code';import{default as EgovLeftNav}from'components/leftmenu/EgovLeftNavAdmin';import EgovRadioButtonGroup from'components/EgovRadioButtonGroup';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EgovAdminBoardEdit(props){var _location$state;console.group(\"EgovAdminBoardEdit\");console.log(\"[Start] EgovAdminBoardEdit ------------------------------\");console.log(\"EgovAdminBoardEdit [props] : \",props);const navigate=useNavigate();const location=useLocation();const checkRef=useRef([]);console.log(\"EgovAdminBoardEdit [location] : \",location);const replyPosblAtRadioGroup=[{value:\"Y\",label:\"가능\"},{value:\"N\",label:\"불가능\"}];const fileAtchPosblAtRadioGroup=[{value:\"Y\",label:\"가능\"},{value:\"N\",label:\"불가능\"}];const bbsTyCodeOptions=[{value:\"\",label:\"선택\"},{value:\"BBST01\",label:\"일반게시판\"},{value:\"BBST03\",label:\"공지게시판\"}];const bbsAttrbCodeOptions=[{value:\"\",label:\"선택\"},{value:\"BBSA02\",label:\"갤러리\"},{value:\"BBSA03\",label:\"일반게시판\"}];const posblAtchFileNumberOptions=[{value:0,label:\"선택하세요\"},{value:1,label:\"1개\"},{value:2,label:\"2개\"},{value:3,label:\"3개\"}];const bbsId=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.bbsId)||\"\";const[modeInfo,setModeInfo]=useState({mode:props.mode});const[boardDetail,setBoardDetail]=useState({});const initMode=()=>{switch(props.mode){case CODE.MODE_CREATE:setModeInfo({...modeInfo,modeTitle:\"등록\",editURL:'/bbsMaster'});break;case CODE.MODE_MODIFY:setModeInfo({...modeInfo,modeTitle:\"수정\",editURL:\"/bbsMaster/\".concat(bbsId)});break;default:navigate({pathname:URL.ERROR},{state:{msg:\"\"}});}retrieveDetail();};const retrieveDetail=()=>{if(modeInfo.mode===CODE.MODE_CREATE){// 조회/등록이면 조회 안함\nsetBoardDetail({tmplatId:\"TMPLAT_BOARD_DEFAULT\",//Template 고정\nreplyPosblAt:\"Y\",//답장가능여부 초기값\nfileAtchPosblAt:\"Y\"//파일첨부가능여부 초기값\n});return;}const retrieveDetailURL=\"/bbsMaster/\".concat(bbsId);const requestOptions={method:\"GET\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(retrieveDetailURL,requestOptions,function(resp){// 수정모드일 경우 조회값 세팅\nif(modeInfo.mode===CODE.MODE_MODIFY){setBoardDetail(resp.result.boardMasterVO);}});};const formValidator=formData=>{if(formData.get('bbsNm')===null||formData.get('bbsNm')===\"\"){alert(\"게시판명은 필수 값입니다.\");return false;}if(formData.get('bbsIntrcn')===null||formData.get('bbsIntrcn')===\"\"){alert(\"게시판 소개는 필수 값입니다.\");return false;}if(formData.get('bbsTyCode')===null||formData.get('bbsTyCode')===\"\"){alert(\"게시판 유형은 필수 값입니다.\");return false;}if(formData.get('bbsAttrbCode')===null||formData.get('bbsAttrbCode')===\"\"){alert(\"게시판 속성은 필수 값입니다.\");return false;}if(formData.get('posblAtchFileNumber')===null||formData.get('posblAtchFileNumber')===\"\"){alert(\"첨부파일 가능 숫자는 필수 값입니다.\");return false;}return true;};const formObjValidator=checkRef=>{if(checkRef.current[0].value===\"\"){alert(\"게시판명은 필수 값입니다.\");return false;}if(checkRef.current[1].value===\"\"){alert(\"게시판 소개는 필수 값입니다.\");return false;}if(checkRef.current[2].value===\"0\"){alert(\"첨부파일 가능 숫자는 필수 값입니다.\");return false;}return true;};const updateBoard=()=>{let modeStr=modeInfo.mode===CODE.MODE_CREATE?\"POST\":\"PUT\";let requestOptions={};if(modeStr===\"POST\"){const formData=new FormData();for(let key in boardDetail){formData.append(key,boardDetail[key]);//console.log(\"boardDetail [%s] \", key, boardDetail[key]);\n}if(formValidator(formData)){requestOptions={method:modeStr,headers:{},body:formData};EgovNet.requestFetch(modeInfo.editURL,requestOptions,resp=>{if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){navigate({pathname:URL.ADMIN_BOARD});}else{navigate({pathname:URL.ERROR},{state:{msg:resp.resultMessage}});}});};}else{if(formObjValidator(checkRef)){requestOptions={method:modeStr,headers:{'Content-type':'application/json'},body:JSON.stringify({...boardDetail})};EgovNet.requestFetch(modeInfo.editURL,requestOptions,resp=>{if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){navigate({pathname:URL.ADMIN_BOARD});}else{navigate({pathname:URL.ERROR},{state:{msg:resp.resultMessage}});}});}}};const deleteBoardArticle=bbsId=>{const deleteBoardURL=\"/bbsMaster/\".concat(bbsId);const requestOptions={method:\"PATCH\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(deleteBoardURL,requestOptions,resp=>{console.log(\"====>>> board delete= \",resp);if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){alert(\"게시글이 삭제되었습니다.\");navigate(URL.ADMIN_BOARD,{replace:true});}else{alert(\"ERR : \"+resp.resultMessage);}});};const getSelectedLabel=function(objArray){let findLabel=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"\";let foundValueLabelObj=objArray.find(o=>o['value']===findLabel);return foundValueLabelObj['label'];};useEffect(()=>{initMode();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);console.log(\"------------------------------EgovAdminBoardEdit [End]\");console.groupEnd(\"EgovAdminBoardEdit\");return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c_wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"location\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.MAIN,className:\"home\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.ADMIN,children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),/*#__PURE__*/_jsx(\"li\",{children:\"\\uAC8C\\uC2DC\\uD310\\uC0DD\\uC131 \\uAD00\\uB9AC\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(EgovLeftNav,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents BOARD_CREATE_REG\",id:\"contents\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"top_tit\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"tit_1\",children:\"\\uC0AC\\uC774\\uD2B8\\uAD00\\uB9AC\"})}),modeInfo.mode===CODE.MODE_CREATE&&/*#__PURE__*/_jsx(\"h2\",{className:\"tit_2\",children:\"\\uAC8C\\uC2DC\\uD310 \\uC0DD\\uC131\"}),modeInfo.mode===CODE.MODE_MODIFY&&/*#__PURE__*/_jsx(\"h2\",{className:\"tit_2\",children:\"\\uAC8C\\uC2DC\\uD310 \\uC218\\uC815\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_view2\",children:[/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"bbsNm\",children:\"\\uAC8C\\uC2DC\\uD310\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"f_input2 w_full\",type:\"text\",name:\"bbsNm\",title:\"\",id:\"bbsNm\",placeholder:\"\",defaultValue:boardDetail.bbsNm,onChange:e=>setBoardDetail({...boardDetail,bbsNm:e.target.value}),ref:el=>checkRef.current[0]=el})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"bbsIntrcn\",children:\"\\uAC8C\\uC2DC\\uD310 \\uC18C\\uAC1C\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"textarea\",{className:\"f_txtar w_full h_100\",name:\"bbsIntrcn\",id:\"bbsIntrcn\",cols:\"30\",rows:\"10\",placeholder:\"\",defaultValue:boardDetail.bbsIntrcn,onChange:e=>setBoardDetail({...boardDetail,bbsIntrcn:e.target.value}),ref:el=>checkRef.current[1]=el})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uAC8C\\uC2DC\\uD310 \\uC720\\uD615\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsxs(\"dd\",{children:[modeInfo.mode===CODE.MODE_CREATE&&/*#__PURE__*/_jsx(\"label\",{className:\"f_select w_130\",htmlFor:\"bbsTyCode\",children:/*#__PURE__*/_jsx(\"select\",{id:\"bbsTyCode\",name:\"bbsTyCode\",title:\"\\uAC8C\\uC2DC\\uD310\\uC720\\uD615\\uC120\\uD0DD\",onChange:e=>setBoardDetail({...boardDetail,bbsTyCode:e.target.value}),value:boardDetail.bbsTyCode,children:bbsTyCodeOptions.map((option,i)=>{return/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value);})})}),modeInfo.mode===CODE.MODE_MODIFY&&/*#__PURE__*/_jsx(\"span\",{children:boardDetail.bbsTyCode&&getSelectedLabel(bbsTyCodeOptions,boardDetail.bbsTyCode)})]})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uAC8C\\uC2DC\\uD310 \\uC18D\\uC131\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsxs(\"dd\",{children:[modeInfo.mode===CODE.MODE_CREATE&&/*#__PURE__*/_jsx(\"label\",{className:\"f_select w_130\",htmlFor:\"bbsAttrbCode\",children:/*#__PURE__*/_jsx(\"select\",{id:\"bbsAttrbCode\",name:\"bbsAttrbCode\",title:\"\\uAC8C\\uC2DC\\uD310\\uC18D\\uC131\\uC120\\uD0DD\",onChange:e=>setBoardDetail({...boardDetail,bbsAttrbCode:e.target.value}),value:boardDetail.bbsAttrbCode,children:bbsAttrbCodeOptions.map((option,i)=>{return/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value);})})}),modeInfo.mode===CODE.MODE_MODIFY&&/*#__PURE__*/_jsx(\"span\",{children:boardDetail.bbsAttrbCode&&getSelectedLabel(bbsAttrbCodeOptions,boardDetail.bbsAttrbCode)})]})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uB2F5\\uC7A5\\uAC00\\uB2A5\\uC5EC\\uBD80\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsxs(\"dd\",{children:[modeInfo.mode===CODE.MODE_CREATE&&/*#__PURE__*/_jsx(EgovRadioButtonGroup,{name:\"replyPosblAt\",radioGroup:replyPosblAtRadioGroup,setValue:boardDetail.replyPosblAt,setter:v=>setBoardDetail({...boardDetail,replyPosblAt:v})}),modeInfo.mode===CODE.MODE_MODIFY&&/*#__PURE__*/_jsx(\"span\",{children:boardDetail.replyPosblAt&&getSelectedLabel(replyPosblAtRadioGroup,boardDetail.replyPosblAt)})]})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[\"\\uD30C\\uC77C\\uCCA8\\uBD80\\uAC00\\uB2A5\\uC5EC\\uBD80\",/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(EgovRadioButtonGroup,{name:\"fileAtchPosblAt\",radioGroup:fileAtchPosblAtRadioGroup,setValue:boardDetail.fileAtchPosblAt,setter:v=>setBoardDetail({...boardDetail,fileAtchPosblAt:v})})})]}),/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsxs(\"dt\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"posblAtchFileNumber\",children:\"\\uCCA8\\uBD80\\uD30C\\uC77C\\uAC00\\uB2A5\\uD30C\\uC77C \\uC22B\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"req\",children:\"\\uD544\\uC218\"})]}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsx(\"label\",{className:\"f_select \",htmlFor:\"posblAtchFileNumber\",children:/*#__PURE__*/_jsx(\"select\",{id:\"posblAtchFileNumber\",name:\"posblAtchFileNumber\",title:\"\\uCCA8\\uBD80\\uAC00\\uB2A5\\uD30C\\uC77C \\uC22B\\uC790\\uC120\\uD0DD\",onChange:e=>setBoardDetail({...boardDetail,posblAtchFileNumber:e.target.value}),value:boardDetail.posblAtchFileNumber,ref:el=>checkRef.current[2]=el,children:posblAtchFileNumberOptions.map((option,i)=>{return/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value);})})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_btn_area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left_col btn1\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_skyblue_h46 w_100\",onClick:()=>updateBoard(),children:\"\\uC800\\uC7A5\"}),modeInfo.mode===CODE.MODE_MODIFY&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_skyblue_h46 w_100\",onClick:()=>{deleteBoardArticle(boardDetail.bbsId);},children:\"\\uC0AD\\uC81C\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"right_col btn1\",children:/*#__PURE__*/_jsx(Link,{to:URL.ADMIN_BOARD,className:\"btn btn_blue_h46 w_100\",children:\"\\uBAA9\\uB85D\"})})]})]})]})]})]})});}export default EgovAdminBoardEdit;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
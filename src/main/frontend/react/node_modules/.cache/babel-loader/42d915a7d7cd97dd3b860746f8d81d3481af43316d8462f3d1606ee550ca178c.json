{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{Link,useLocation}from'react-router-dom';import*as EgovNet from'api/egovFetch';import URL from'constants/url';import CODE from'constants/code';import{default as EgovLeftNav}from'components/leftmenu/EgovLeftNavInform';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function EgovWeeklyList(props){var _location$state;console.group(\"EgovWeeklyList\");console.log(\"[Start] EgovWeeklyList ------------------------------\");console.log(\"EgovWeeklyList [props] : \",props);const location=useLocation();console.log(\"EgovWeeklyList [location] : \",location);const DATE=new Date();const FIRST_DAY_OF_THIS_WEEK=new Date(DATE.getFullYear(),DATE.getMonth(),DATE.getDate()-DATE.getDay());const getWeekOfMonth=date=>{let adjustedDate=date.getDate()+date.getDay();console.log(\"getWeekOfMonth : \",date,date.getDate(),date.getDay(),adjustedDate,adjustedDate/7,0|adjustedDate/7);let weeksOrder=[0,1,2,3,4,5];let returnVal=parseInt(weeksOrder[0|adjustedDate/7]);console.log(\"returnVal:\",returnVal);return returnVal;};const[searchCondition,setSearchCondition]=useState(((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.searchCondition)||{schdulSe:'',year:FIRST_DAY_OF_THIS_WEEK.getFullYear(),month:FIRST_DAY_OF_THIS_WEEK.getMonth(),date:FIRST_DAY_OF_THIS_WEEK.getDate(),weekDay:FIRST_DAY_OF_THIS_WEEK.getDay(),weekOfMonth:getWeekOfMonth(FIRST_DAY_OF_THIS_WEEK)});const[scheduleList,setScheduleList]=useState([]);const[listTag,setListTag]=useState([]);const changeDate=(target,amount)=>{let changedDate;if(target===CODE.DATE_YEAR){changedDate=new Date(searchCondition.year+amount,searchCondition.month,searchCondition.date);}if(target===CODE.DATE_MONTH){changedDate=new Date(searchCondition.year,searchCondition.month+amount,searchCondition.date);}if(target===CODE.DATE_WEEK){// let addtionOfDays = 7 * amount - searchCondition.weekDay;\nlet addtionOfDays=7*amount;changedDate=new Date(searchCondition.year,searchCondition.month,searchCondition.date+addtionOfDays);//다음주의 첫날\n}console.log(\"changedDate : \",changedDate);setSearchCondition({...searchCondition,year:changedDate.getFullYear(),month:changedDate.getMonth(),date:changedDate.getDate(),weekDay:changedDate.getDay(),weekOfMonth:getWeekOfMonth(changedDate)});};const drawList=useCallback(()=>{const dayNames=[\"일요일\",\"월요일\",\"화요일\",\"수요일\",\"목요일\",\"금요일\",\"토요일\"];let mutListTag=[];let keyPropertyCnt=0;// 리스트 항목 구성\nfor(let dayIdx=0;dayIdx<7;dayIdx++){let scheduleDate=new Date(searchCondition.year,searchCondition.month,searchCondition.date+dayIdx);let scheduleDateStr=scheduleDate.getFullYear()+\"년 \"+(scheduleDate.getMonth()+1)+\"월 \"+scheduleDate.getDate()+\"일 \"+dayNames[scheduleDate.getDay()];let scheduleBgDate=scheduleDate.getFullYear()+(\"00\"+(scheduleDate.getMonth()+1).toString()).slice(-2)+(\"00\"+scheduleDate.getDate().toString()).slice(-2);keyPropertyCnt++;let mutSubListTag=[];let slicedScheduleList=[];//scheduleList는 일주일치 일정을 한번에 가져온 데이터\n//scheduleList를 순환하면서 날짜에 맞는 걸로만 재구성\nscheduleList.forEach((currentElement,index)=>{// 하루짜리 일정일 경우 시작일과 날짜가 일치하면\nif(currentElement.schdulBgnde.substring(0,8)===currentElement.schdulEndde.substring(0,8)&&currentElement.schdulBgnde.substring(0,8)===scheduleBgDate){slicedScheduleList.push(scheduleList[index]);// 이틀 이상 일정일 경우 시작일이 날짜보다 작거나 같으면 (그리고 종료일이 날짜보다 크거나 같으면)\n}else if(currentElement.schdulBgnde.substring(0,8)!==currentElement.schdulEndde.substring(0,8)&&currentElement.schdulBgnde.substring(0,8)<=scheduleBgDate&&currentElement.schdulEndde.substring(0,8)>=scheduleBgDate){slicedScheduleList.push(scheduleList[index]);}});//재구성된 게 없으면(즉, 일주일치 일정이 없으면)\nif(slicedScheduleList.length===0){mutListTag.push(/*#__PURE__*/_jsxs(\"div\",{className:\"list_item\",children:[/*#__PURE__*/_jsx(\"div\",{children:scheduleDateStr}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uC77C\\uC815\\uC774 \\uC874\\uC7AC\\uD558\\uC9C0 \\uC54A\\uC2B5\\uB2C8\\uB2E4.\"})})]},keyPropertyCnt));}else{mutListTag.push(/*#__PURE__*/_jsxs(\"div\",{className:\"list_item\",children:[/*#__PURE__*/_jsx(\"div\",{children:scheduleDateStr}),/*#__PURE__*/_jsx(\"div\",{children:mutSubListTag})]},keyPropertyCnt));let subKeyPropertyCnt=0;mutSubListTag.push(/*#__PURE__*/_jsx(_Fragment,{children:slicedScheduleList.length!==0&&slicedScheduleList.map(item=>{subKeyPropertyCnt++;return/*#__PURE__*/_jsxs(Link,{to:{pathname:URL.INFORM_WEEKLY_DETAIL},state:{schdulId:item.schdulId,prevPath:URL.INFORM_WEEKLY},children:[/*#__PURE__*/_jsxs(\"span\",{children:[getTimeForm(item.schdulBgnde),\" ~ \",getTimeForm(item.schdulEndde)]}),/*#__PURE__*/_jsx(\"span\",{children:item.schdulNm}),/*#__PURE__*/_jsx(\"span\",{children:item.userNm})]},subKeyPropertyCnt);})}));}}setListTag(mutListTag);},[scheduleList,searchCondition.date,searchCondition.month,searchCondition.year]);const retrieveList=useCallback(srchcnd=>{console.groupCollapsed(\"EgovWeeklyList.retrieveList()\");const retrieveListURL='/schedule/week'+EgovNet.getQueryString(srchcnd);const requestOptions={method:\"GET\",headers:{'Content-type':'application/json'}};EgovNet.requestFetch(retrieveListURL,requestOptions,resp=>{setScheduleList(resp.result.resultList);drawList();},function(resp){console.log(\"err response : \",resp);});console.groupEnd(\"EgovWeeklyList.retrieveList()\");},[drawList]);const Location=/*#__PURE__*/React.memo(function Location(){return/*#__PURE__*/_jsx(\"div\",{className:\"location\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.MAIN,className:\"home\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:URL.INFORM,children:\"\\uC54C\\uB9BC\\uB9C8\\uB2F9\"})}),/*#__PURE__*/_jsx(\"li\",{children:\"\\uAE08\\uC8FC\\uC758 \\uD589\\uC0AC\"})]})});});const getTimeForm=str=>{let hour=str.substring(8,10);let starminute=str.substring(10,12);return hour+\":\"+starminute;};useEffect(()=>{retrieveList(searchCondition);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[searchCondition]);useEffect(()=>{drawList();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[scheduleList]);console.log(\"------------------------------EgovWeeklyList [End]\");console.groupEnd(\"EgovWeeklyList\");return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c_wrap\",children:[/*#__PURE__*/_jsx(Location,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"layout\",children:[/*#__PURE__*/_jsx(EgovLeftNav,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"contents WEEK_SCHEDULE\",id:\"contents\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"top_tit\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"tit_1\",children:\"\\uC54C\\uB9BC\\uB9C8\\uB2F9\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"tit_2\",children:\"\\uAE08\\uC8FC\\uC758 \\uD589\\uC0AC\"}),/*#__PURE__*/_jsx(\"div\",{className:\"condition\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"label\",{className:\"f_select\",htmlFor:\"sel1\",children:/*#__PURE__*/_jsxs(\"select\",{name:\"\",id:\"sel1\",title:\"\\uC870\\uAC74\",onChange:e=>{setSearchCondition({...searchCondition,schdulSe:e.target.value});},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC804\\uCCB4\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"\\uD68C\\uC758\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"\\uC138\\uBBF8\\uB098\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"\\uAC15\\uC758\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"\\uAD50\\uC721\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"\\uAE30\\uD0C0\"})]})})}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"prev\",onClick:()=>{changeDate(CODE.DATE_YEAR,-1);}}),/*#__PURE__*/_jsxs(\"span\",{children:[searchCondition.year,\"\\uB144\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"next\",onClick:()=>{changeDate(CODE.DATE_YEAR,1);}})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"half L\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"prev\",onClick:()=>{changeDate(CODE.DATE_MONTH,-1);}}),/*#__PURE__*/_jsxs(\"span\",{children:[searchCondition.month+1,\"\\uC6D4\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"next\",onClick:()=>{changeDate(CODE.DATE_MONTH,1);}})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"half R\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"prev\",onClick:()=>{changeDate(CODE.DATE_WEEK,-1);}}),/*#__PURE__*/_jsxs(\"span\",{children:[searchCondition.weekOfMonth+1,\"\\uC8FC\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"next\",onClick:()=>{changeDate(CODE.DATE_WEEK,1);}})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"board_list BRD003\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"head\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uC2DC\\uAC04\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uC81C\\uBAA9\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\uB2F4\\uB2F9\\uC790\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"result\",children:listTag})]})]})]})]})});}export default EgovWeeklyList;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
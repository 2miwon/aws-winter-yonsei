{"ast":null,"code":"import React from'react';import{useNavigate}from'react-router-dom';import URL from'constants/url';import*as EgovNet from'api/egovFetch';import{SERVER_URL}from'config';import CODE from'constants/code';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function EgovAttachFile(_ref){let{boardFiles,mode,fnChangeFile,fnDeleteFile,posblAtchFileNumber}=_ref;console.groupCollapsed(\"EgovAttachFile\");// posblAtchFileNumber는 수정일 경우에만 값이 넘어오므로 방어 로직\n// 해당 컴포넌트는 스케줄 화면과 공유하며, 스케줄에서는 첨부파일을 1개 넣을 수 있으므로 디폴트 값을 1로 설정\nif(typeof posblAtchFileNumber==\"undefined\"||posblAtchFileNumber==null){posblAtchFileNumber=1;}const navigate=useNavigate();function onClickDownFile(atchFileId,fileSn){window.open(SERVER_URL+\"/file?atchFileId=\"+atchFileId+\"&fileSn=\"+fileSn+\"\");}function onClickDeleteFile(atchFileId,fileSn,fileIndex){console.log(\"onClickDeleteFile Params : \",atchFileId,fileSn,fileIndex);const requestOptions={method:\"POST\",headers:{'Content-type':'application/json'},body:JSON.stringify({atchFileId:atchFileId,fileSn:fileSn})};EgovNet.requestFetch(\"/file\",requestOptions,function(resp){console.log(\"===>>> board file delete= \",resp);if(Number(resp.resultCode)===Number(CODE.RCV_SUCCESS)){// 성공\nconsole.log(\"Deleted fileIndex = \",fileIndex);// eslint-disable-next-line no-unused-vars\nconst _deleteFile=boardFiles.splice(fileIndex,1);const _boardFiles=Object.assign([],boardFiles);fnDeleteFile(_boardFiles);alert(\"첨부파일이 삭제되었습니다.\");fnChangeFile({});}else{navigate({pathname:URL.ERROR},{state:{msg:resp.resultMessage}});}});}function onChangeFileInput(e){console.log(\"===>>> e = \"+e.target.files[0]);if(e.target.files.length+((boardFiles===null||boardFiles===void 0?void 0:boardFiles.length)||0)>posblAtchFileNumber){alert('총 첨부파일 개수는 '+posblAtchFileNumber+' 까지 입니다.');e.target.value=null;// 파일 입력란 화면 초기화\nfnChangeFile({});// 상위 컴포넌트의 저장된 값 초기화\nreturn false;}fnChangeFile(e.target.files);}let filesTag=[];if(boardFiles!==undefined){boardFiles.forEach(function(item,index){filesTag.push(/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"a\",{href:\"#LINK\",onClick:function(e){e.preventDefault();onClickDownFile(item.atchFileId,item.fileSn);},download:true,children:item.orignlFileNm}),/*#__PURE__*/_jsxs(\"span\",{children:[\"[\",item.fileMg,\"byte]\"]})]})},index));if(mode===CODE.MODE_MODIFY){filesTag.push(/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_delete\",onClick:e=>{onClickDeleteFile(item.atchFileId,item.fileSn,index);}})},[\"button\",\"\".concat(index)].join(\" \")));}filesTag.push(/*#__PURE__*/_jsx(\"br\",{},[\"br\",\"\".concat(index)].join(\" \")));});}console.log(\"filesTag : \",filesTag);console.groupEnd(\"EgovAttachFile\");return/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsx(\"dt\",{children:\"\\uCCA8\\uBD80\\uD30C\\uC77C\"}),/*#__PURE__*/_jsx(\"dd\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"file_attach\",children:[filesTag,mode===CODE.MODE_CREATE&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"file_0\",id:\"egovComFileUploader\",type:\"file\",multiple:true,onChange:e=>onChangeFileInput(e)}),\"\\uCD1D \\uC5C5\\uB85C\\uB4DC \\uAC00\\uB2A5\\uD55C \\uCCA8\\uBD80\\uD30C\\uC77C \\uAC1C\\uC218\\uB294 \",posblAtchFileNumber,\" \\uAC1C \\uC785\\uB2C8\\uB2E4.\"]}),mode===CODE.MODE_MODIFY&&filesTag.length/3<posblAtchFileNumber&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"file_0\",id:\"egovComFileUploader\",type:\"file\",multiple:true,onChange:e=>onChangeFileInput(e)}),\"\\uD604\\uC7AC \\uC5C5\\uB85C\\uB4DC \\uAC00\\uB2A5\\uD55C \\uCCA8\\uBD80\\uD30C\\uC77C \\uAC1C\\uC218\\uB294 \",posblAtchFileNumber-filesTag.length/3,\" \\uAC1C \\uC785\\uB2C8\\uB2E4.\"]})]})})]});}export default/*#__PURE__*/React.memo(EgovAttachFile);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}